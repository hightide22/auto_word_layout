# auto_word_layout
Предобработка:

Задать роль стилей в вашем файле можно в input/config.txt ![](md/Screenshot_1.png)
Если использованный стиль не указан в файле и его автоматически не определил как стиль списка, подписи к рисунку или заголовка источников, абзац с этим стилем не будет изменён и название стиля будет выведено в терминал.
Для работы нужна `python-docx`

Затем нужно запустить `prerun.py` с названием документа(в папке `input`), который хотите обработать
Он создаст копию `work_c.docx` и добавит в неё стили. НЕОБХОДИМО открыть этот файл и применить к любому абзацу новые стили хотя бы по 1 разу([почему так](https://python-docx.readthedocs.io/en/latest/user/styles-understanding.html#:~:text=Although%20those%20styles,use%20but%20haven%E2%80%99t.))
Если на этом этапе выдаёт ошибку, что стиля не существует, нужно в вашем документе создать новый стиль на основе этого стиля(Нужны заголовки 1 и 2 уровней)
![](md/Screenshot_2.png)


Теперь можно запустить `main.py`. Он создаст 2 файла в output: `work_c.docx` с исправленным нормоконтролем и `diffs.docx`, в котором показаны изменения:
Жёлтое подчёркивание, если изменён стиль и красный шрифт, если изменён текст
## Что пока не работает

- Таблицы и картинки не изменяются
- Абзацы с формулами обрабатываются как обычный текст, т.е. у них меняется выравнивание по ширине, а не по тексту
- Текст кода
- Стили пока захардкожены



## Как определяется стиль параграфа
- Основной и заголовки первого и второго уровня задаются в файле
- Если к абзацу применён список, то он становится списком своего типа
- Если в тексте есть `рисунок` и `(рисунок ` отсутствует, он становится стилем рисунка
- Если в тексте есть слово `часть` и в нём не более 3 слов, он становится стилем заголовка источников (ТЕОРЕТИЧЕСКАЯ ЧАСТЬ, ПРАКТИЧЕСКАЯ ЧАСТЬ)


## Изменения текста
- Во всех параграфах заменяются двойные пробелы, неразрывные пробелы, дефисы, окружённые пробелами, на тире неправильные кавычки, добавляются пробелы там, где это нужно
- В списках меняется регистр первой буквы и `.`, `;` в конце
- рисунок заменяется на Рисунок, минус заменяется на тире 